// dot -Tps imm_stats.dot -o imm_stats.ps
digraph instr_supprt {
    
      
  T [label="Total\n3868"]
    SYS         [style=dashed; label="System\n203"] 
    CRYPTO      [style=dashed; label="Crypto\n35"] 
    X87         [style=dashed; label="X87\n155"] 
    BASE        [style=filled; label="Base\n51"] 
    REM         [style=filled; label="Remaining\n2878"]
    US          [style=dashed; label="Sanbox Unsupported\n103"] 
    JMP         [style=filled; label="Jump\n263"] 
    MMX         [style=dashed; label="mmx operand\n180"] 
  
  T -> SYS  
  T -> CRYPTO  
  T -> X87  
  T -> US  
  T -> BASE  
  T -> REM
  T -> JMP  
  T -> MMX  

  {rank = same; T; }
  {rank = same; SYS; CRYPTO; X87; US; JMP; MMX;  }
  {rank = same; REM, BASE}

  /***************************************************/
  // Remaining

  DUP      [label="Duplicate\n120"] 
  MEM      [label="Memory\n1367"] 
  IMMS [label="Immediates\n308"]
  REGS [label="Registers\n1083"]

  REM -> DUP
  REM -> MEM
  REM -> IMMS
  REM -> REGS
  {rank = same; DUP; MEM; IMMS; REGS;}

  /***************************************************/
  // Registers
  subgraph cluster_0 {
    label =  "Register"
    style=filled;
    color = cadetblue1;

    REGS_STRATA [label="Stratified\n692"] 
    REGS_UNSTRATA [label="Strata Unsupported\n391"] 
    REGS_UNSTRATA_STOKED [fontcolor=red; color=red; label="#1\nStrata Unsupported, Stoked\n262"] 
    REGS_UGUSUS [fontcolor=red; color=red; label="#2\nTo Be Implemented\n129"]

    REGS -> REGS_STRATA
    REGS -> REGS_UNSTRATA
    REGS_UNSTRATA -> REGS_UNSTRATA_STOKED
    REGS_UNSTRATA -> REGS_UGUSUS

    {rank = same; REGS_STRATA; REGS_UNSTRATA; }
    {rank = same; REGS_UNSTRATA_STOKED; REGS_UGUSUS; }
  }
  /***************************************************/

  /***************************************************/
  // Memory
  subgraph cluster_1 {
    label =  "Memory"
    style=filled;
    color = lightpink;

    MEM_G [label="Generalized from regs\nwo/w extend: 996/189\n1185"]
    MEM_UG [label="UnGeneralized\n182"]

    MEM -> MEM_G
    MEM -> MEM_UG

    {rank = same; MEM_UG; MEM_G; }
  }
  /***************************************************/

 /***************************************************/
 // Immediates
  subgraph cluster_2 {
    label =  "Immediate";
    style=filled;
    color = cornsilk;

    G [label="Generalized from Regs\nwo/w extend: 107/83\n190"] 
    S1 [label="Stratified (Why Stratified if Generalized??)\n28"] 
    S [label="Strata\n106"] 
    UG [label="UnGeneralized\n118"] 
    UGUS [label="UnGeneralized UnStratified\n40"]
    S2 [label="Stratified\n78"] 
    UGUSS [fontcolor=red; color=red; label="#3\nUnGeneralized UnStratified Stoked \n9"]
    UGUSUS [fontcolor=red; color=red; label="#4\nUnGeneralized UnStratified UnStoked\n31"]
    S2_STOKED [fontcolor=red; color=red; label="#5\nStratified & Stoked\n15"]
    S2_UNSTOKED [fontcolor=red; color=red; label="#6\nStratified & Not Stoked\n63"]

    IMMS -> G
    IMMS -> UG

    G -> S1 -> S
    G -> 162
    UG -> S2 -> S
    UG -> UGUS -> UGUSS
    UGUS -> UGUSUS
    S2 -> S2_STOKED
    S2 -> S2_UNSTOKED

    {rank = same; IMMS; }
    {rank = same; G; UG; }
    {rank = same; S1; S2; UGUS }
    {rank = same; S; UGUSUS  }
    {rank = same; S2_STOKED;S2_UNSTOKED   }
  }
 /***************************************************/

 }
